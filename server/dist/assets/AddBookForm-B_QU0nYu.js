import{u as L,a as I,r as n,j as e,C as l,p as A,N as G}from"./index-D6hQ08Y0.js";import{a as B}from"./constants-DytKgnBF.js";import{A as D}from"./arrow-left-CQ6JUytA.js";import{X as y}from"./x-BL0ellVK.js";import{c as F}from"./createLucideIcon-C9Hrp4nZ.js";import{I as U}from"./image-BieguV6P.js";import{C as z}from"./chevron-down-C4ZA3iw4.js";import{L as M}from"./loader-circle-BYwwIi0_.js";import"./clock-JQ9xzxrc.js";import"./book-open-CQ8IbAVz.js";import"./check-check-CE3MAPcn.js";import"./circle-check-big-D7MaoHrP.js";const R=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],q=F("upload",R),Z=()=>{const v=L(),j=I(),[x,b]=n.useState(!1),[s,i]=n.useState({title:"",author:"",description:"",genre:[],availabilityType:[],condition:"good"}),[f,d]=n.useState(null),[u,g]=n.useState(null),[p,m]=n.useState([]),[w,h]=n.useState([]),c=a=>{const{name:r,value:o}=a.target;i(t=>({...t,[r]:o}))},N=a=>{i(r=>{const o=r.genre;return o.includes(a)?{...r,genre:o.filter(t=>t!==a)}:{...r,genre:[...o,a]}})},k=a=>{i(r=>{const o=r.availabilityType;return o.includes(a)?{...r,availabilityType:o.filter(t=>t!==a)}:{...r,availabilityType:[...o,a]}})},C=a=>{const r=a.target.files[0];r&&(d(r),g(URL.createObjectURL(r)))},T=a=>{const r=Array.from(a.target.files);if(p.length+r.length>5){l.error("You can only upload a maximum of 5 additional images.");return}const o=r.map(t=>URL.createObjectURL(t));m(t=>[...t,...r]),h(t=>[...t,...o])},P=a=>{m(r=>r.filter((o,t)=>t!==a)),h(r=>r.filter((o,t)=>t!==a))},S=async a=>{if(a.preventDefault(),!f)return l.error("Cover image is required!");if(!s.title||!s.author)return l.error("Title and Author are required!");if(s.availabilityType.length===0)return l.error("Please select at least one purpose.");if(s.genre.length===0)return l.error("Please select at least one genre.");b(!0);const r=new FormData;r.append("title",s.title),r.append("author",s.author),r.append("description",s.description),r.append("condition",s.condition),r.append("availabilityType",JSON.stringify(s.availabilityType)),r.append("genre",JSON.stringify(s.genre)),r.append("coverImage",f),p.forEach(o=>{r.append("galleryImages",o)}),console.log(r);try{const{data:o}=await A.post("/books/add",r);o.statusCode===400?l.error(o.error?.data?.message??"Something went wrong!"):(l.success(o.message?o.message:"Book added successfully!"),d(null),g(null),m([]),h([]),i({title:"",author:"",description:"",genre:[],availabilityType:[],condition:"good"}),j(G(o.book)))}catch(o){console.error(o);const t=o.response?.data?.message||"";t.includes("location")||t.includes("profile")?l.error("Incomplete Profile: Please add your Address in settings first.",{duration:4e3}):l.error(t||"Failed to add book")}finally{b(!1)}};return e.jsxs("div",{className:"max-w-4xl mx-auto p-6 bg-white rounded-2xl shadow-sm border border-gray-100 my-10",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("button",{onClick:()=>v(-1),className:"p-2 rounded-full hover:bg-gray-100 text-gray-600 transition-colors",title:"Go Back",children:e.jsx(D,{size:24})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"List a Book"})]}),e.jsxs("form",{onSubmit:S,className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Book Cover ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative group w-full h-64 bg-gray-50 border-2 border-dashed border-gray-300 rounded-xl flex flex-col items-center justify-center overflow-hidden transition-colors hover:bg-orange-50 hover:border-orange-300",children:[u?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:u,alt:"Preview",className:"w-full h-full object-contain p-2"}),e.jsx("button",{type:"button",onClick:()=>{d(null),g(null)},className:"absolute top-2 right-2 bg-white p-1.5 rounded-full shadow-md hover:bg-red-50 text-red-500 transition-colors",children:e.jsx(y,{size:16})})]}):e.jsxs(e.Fragment,{children:[e.jsx(q,{className:"w-8 h-8 text-gray-400 mb-2 group-hover:text-orange-500 transition-colors"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Click to upload cover"})]}),e.jsx("input",{type:"file",accept:"image/*",onChange:C,className:`absolute inset-0 w-full h-full opacity-0 cursor-pointer ${u?"pointer-events-none":""}`})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Additional Images (Max 5). ",e.jsxs("span",{className:"text-red-500 tracking-tighter text-xs",children:[e.jsx("br",{}),"Make sure you're adding real images of your book here.*"]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[w.map((a,r)=>e.jsxs("div",{className:"relative aspect-square rounded-lg overflow-hidden border border-gray-200 group",children:[e.jsx("img",{src:a,alt:`Gallery ${r}`,className:"w-full h-full object-cover"}),e.jsx("button",{type:"button",onClick:()=>P(r),className:"absolute top-1 right-1 bg-black/50 text-white p-1 rounded-full opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(y,{size:12})})]},r)),p.length<5&&e.jsxs("div",{className:"relative aspect-square bg-gray-50 border-2 border-dashed border-gray-300 rounded-lg flex items-center justify-center hover:bg-orange-50 hover:border-orange-300 transition-colors",children:[e.jsx(U,{className:"w-5 h-5 text-gray-400"}),e.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:T,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer"})]})]})]})]}),e.jsxs("div",{className:"space-y-5 ",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold uppercase text-gray-500 mb-1",children:"Book Title"}),e.jsx("input",{type:"text",name:"title",value:s.title,onChange:c,placeholder:"e.g. The Alchemist",className:"w-full rounded-lg border border-gray-200 px-4 py-2.5 text-sm focus:border-orange-500 focus:ring-1 focus:ring-orange-500 outline-none transition-all"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold uppercase text-gray-500 mb-1",children:"Author"}),e.jsx("input",{type:"text",name:"author",value:s.author,onChange:c,placeholder:"e.g. Paulo Coelho",className:"w-full rounded-lg border border-gray-200 px-4 py-2.5 text-sm focus:border-orange-500 focus:ring-1 focus:ring-orange-500 outline-none transition-all"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold uppercase text-gray-500 mb-2",children:"Genre (Select Multiple)"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:B.map(a=>{const r=s.genre.includes(a);return e.jsx("button",{type:"button",onClick:()=>N(a),className:`
                      px-3 py-1.5 rounded-full text-xs font-medium border transition-all
                      ${r?"bg-orange-500 border-orange-500 text-white shadow-sm":"bg-white border-gray-200 text-gray-600 hover:border-orange-300 hover:bg-orange-50"}
                    `,children:a},a)})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold uppercase text-gray-500 mb-1",children:"Condition"}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{name:"condition",value:s.condition,onChange:c,className:"w-full appearance-none rounded-lg border border-gray-200 px-4 py-2.5 text-sm focus:border-orange-500 focus:ring-1 focus:ring-orange-500 outline-none bg-white cursor-pointer transition-all",children:[e.jsx("option",{value:"new",children:"New (Unused)"}),e.jsx("option",{value:"good",children:"Good (Lightly Used)"}),e.jsx("option",{value:"fair",children:"Fair (Readable)"}),e.jsx("option",{value:"poor",children:"Poor (Heavily Worn)"})]}),e.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center px-3 pointer-events-none text-gray-500",children:e.jsx(z,{size:16})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold uppercase text-gray-500 mb-2",children:"Purpose (Select all that apply)"}),e.jsx("div",{className:"grid grid-cols-3 gap-3",children:["swap","borrow","donate"].map(a=>{const r=s.availabilityType.includes(a);return e.jsx("div",{onClick:()=>k(a),className:`
                      cursor-pointer text-center py-2.5 rounded-lg border text-sm font-medium capitalize transition-all select-none
                      ${r?"bg-orange-500 border-orange-500 text-white shadow-md":"bg-white border-gray-200 text-gray-600 hover:border-orange-300 hover:bg-orange-50"}
                    `,children:a},a)})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold uppercase text-gray-500 mb-1",children:"Description"}),e.jsx("textarea",{name:"description",rows:5,value:s.description,onChange:c,className:"w-full rounded-lg border border-gray-200 px-4 py-2.5 text-sm focus:border-orange-500 focus:ring-1 focus:ring-orange-500 outline-none resize-none transition-all",placeholder:"Tell us about the condition of the book..."})]}),e.jsx("button",{type:"submit",disabled:x,className:"w-full bg-black hover:bg-gray-800 text-white font-medium py-3 rounded-xl transition-all shadow-lg hover:shadow-xl disabled:opacity-50 disabled:cursor-not-allowed flex justify-center items-center gap-2",children:x?e.jsx(M,{className:"animate-spin h-5 w-5"}):"Post Book"})]})]})]})};export{Z as default};
